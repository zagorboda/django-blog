<!DOCTYPE html>
<html>

<head>
    <title>Create post</title>
    <meta charset="UTF-8">
</head>

<body>

    <form id="post_form" method="POST", enctype="multipart/form-data">
        <ul>
            <li>
                <label for="post_title">Title:</label>
                <input type="text" id="post_title" name="post_title">
            </li>

            <li>
                <label for="post_content">Content:</label>
                <input type="text" id="post_content" name="post_content">
            </li>

            <li>
                <input type="file" id="file" name="file">
                <button type="button" onclick="clear_file()">Clear</button>
            </li>

            <li>
              <button type="button" onclick="send_data()">Create post</button>
            </li>
        </ul>
    </form>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script>

    function clear_file(){
      document.getElementById('file').value = "";
    }

    function send_data() {
      url = 'http://127.0.0.1:8000/api/blog/new-post/';

      var post_formData = new FormData();
      var post_imagefile = document.querySelector('#file');
      console.log(post_imagefile);
      console.log(post_imagefile.files);
      if (typeof post_imagefile.files !== 'undefined' && post_imagefile.files.length > 0) {
          post_formData.append("image", post_imagefile.files[0]);
      }
      post_formData.append('title', document.getElementById('post_title').value);
      post_formData.append('content', document.getElementById('post_content').value);
      var tags = ['music', 'sport', 'tech'];
      for (var i = 0; i < tags.length; i++) {
          post_formData.append('tags', tags[i]);
      }

      const request_headers = {
          'Content-Type': 'multipart/form-data',
          'Authorization': 'Token 88c6d0f3a95156eb4397b0f40a854b2874f45526'
      }

      axios.post('http://127.0.0.1:8000/api/blog/new-post/', post_formData, {
        headers: request_headers
      });
    }



    </script>

</body>

</html>
